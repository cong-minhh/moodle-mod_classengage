{"version":3,"file":"generator_wizard.min.js","sources":["../src/generator_wizard.js"],"sourcesContent":["define([\n    'jquery',\n    'core/modal_factory',\n    'core/modal_events',\n    'core/templates',\n    'core/ajax',\n    'core/notification',\n    'core/str'\n], function($, ModalFactory, ModalEvents, Templates, Ajax, Notification, Str) {\n\n    var GeneratorWizard = {\n        modal: null,\n        cmid: null,\n        slideid: null,\n        docid: null,\n        pages: [],\n\n        init: function(cmid) {\n            this.cmid = cmid;\n            \n            // Event delegation for the Generate button on slides page\n            $(document).on('click', '[data-action=\"open-generator\"]', function(e) {\n                e.preventDefault();\n                var btn = $(e.currentTarget);\n                this.slideid = btn.data('slideid');\n                this.openWizard();\n            }.bind(this));\n        },\n\n        openWizard: function() {\n            var self = this;\n\n            ModalFactory.create({\n                type: ModalFactory.types.DEFAULT,\n                large: true\n            }).then(function(modal) {\n                self.modal = modal;\n                \n                // Set Title\n                Str.get_string('generatefromdocument', 'mod_classengage').then(function(title) {\n                    modal.setTitle(title);\n                });\n\n                // Set Body\n                Templates.render('mod_classengage/generator_wizard', {\n                    numquestions_options: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 15, 20]\n                }).then(function(html, js) {\n                    modal.setBody(html);\n                    Templates.runTemplateJS(js);\n                });\n\n                // Set Footer\n                Templates.render('mod_classengage/generator_wizard_footer', {}).then(function(html, js) {\n                    modal.setFooter(html);\n                    Templates.runTemplateJS(js);\n                });\n\n                modal.show();\n\n                // Start Inspection\n                self.inspectDocument();\n\n                // Bind Modal Events\n                var root = modal.getRoot();\n                \n                // Range Input Handler\n                root.on('change', '#id_pagerange', function() {\n                    self.updateSelectionFromRange($(this).val());\n                });\n\n                // Select All Handler\n                root.on('change', '#select-all-slides', function() {\n                    var checked = $(this).is(':checked');\n                    root.find('.slide-toggle').prop('checked', checked);\n                    // Also toggle all images if selecting all slides\n                    if (checked) {\n                        root.find('.image-toggle').prop('checked', true);\n                    }\n                });\n\n                // Generate Confirm Click\n                // Note: Footer is separate now, so we need to target it specifically or search in root\n                // Modal root usually contains footer\n                root.on('click', '#btn-generate-confirm', function() {\n                    self.triggerGeneration();\n                });\n                \n                // Show More Text\n                root.on('click', '.show-more-text', function(e) {\n                    e.preventDefault();\n                    var link = $(this);\n                    alert(link.data('fulltext'));\n                });\n\n                // Auto-Show Distribution on Dropdown Change\n                root.on('change', '#id_difficulty, #id_cognitive, #id_numquestions', function() {\n                     self.checkDistributionVisibility();\n                });\n\n                // Manual Input Change -> Validate\n                root.on('input', '.dist-input', function() {\n                    self.validateDistribution();\n                });\n\n            }).fail(Notification.exception);\n        },\n\n        inspectDocument: function() {\n            var self = this;\n            \n            Ajax.call([{\n                methodname: 'mod_classengage_inspect_document', // We don't have a webservice, using direct AJAX script\n                args: {} // Not used for script call\n            }]);\n            \n            // Using direct fetch to slides_api.php as we did before, but cleaner\n            // Moodle 4.x prefers service calls, but we are using existing pattern for now.\n            // Actually, we should use Ajax.call if it was a WS. Since it's a script, we use jQuery.ajax \n            // BUT core/ajax is better for session handling. \n            // Let's use simple $.ajax to our endpoint.\n\n            $.ajax({\n                url: M.cfg.wwwroot + '/mod/classengage/slides_api.php',\n                data: {\n                    action: 'inspect',\n                    slideid: self.slideid,\n                    sesskey: M.cfg.sesskey\n                },\n                dataType: 'json',\n                success: function(response) {\n                    if (response.success) {\n                        self.docid = response.docid;\n                        self.pages = response.pages;\n                        self.renderPages();\n                    } else {\n                        self.modal.setBody('<div class=\"alert alert-danger\">' + response.error + '</div>');\n                    }\n                },\n                error: function() {\n                    self.modal.setBody('<div class=\"alert alert-danger\">Network error during inspection.</div>');\n                }\n            });\n        },\n\n        renderPages: function() {\n            var self = this;\n            var container = self.modal.getRoot().find('#slides-container');\n            container.empty();\n\n            var context = { pages: [] };\n            \n            // Process pages for template\n            this.pages.forEach(function(page) {\n                var shorttext = page.text.replace(/<[^>]+>/g, '').substring(0, 100);\n                var images = [];\n                \n                if (page.images) {\n                    page.images.forEach(function(img) {\n                        // We need safe source for ID\n                        // We can't use bin2hex easily in JS consistently with PHP without library\n                        // But we can just use a sanitised string or index if needed.\n                        // Actually, let's just use the source string and hope it works in HTML attribute (it should if quoted)\n                        // Wait, previous issue was PHP array keys. We are sending JSON now.\n                        // JSON keys can be anything. So we don't need hex encoding here!\n                        images.push({\n                            source: img.source,\n                            safe_source: img.source, // No hex needed for JSON payload\n                            mediaType: img.mediaType,\n                            data: img.data\n                        });\n                    });\n                }\n\n                self.modal.getRoot().find('#slides-container').append(\n                    Templates.render('mod_classengage/generator_slide_row', {\n                        pagenum: page.page,\n                        shorttext: shorttext,\n                        fulltext: page.text, // For popup\n                        hasmore: page.text.length > 100,\n                        images: images\n                    })\n                );\n            });\n            \n            // Since Templates.render returns a promise when directly appended, we might have issues?\n            // \"Templates.render\" returns a promise that resolves to (html, js).\n            // Better to use renderForPromise logic or wait.\n            \n            // Correct approach:\n            var promises = [];\n            this.pages.forEach(function(page) {\n                var shorttext = page.text.replace(/<[^>]+>/g, '').substring(0, 100);\n                 var images = [];\n                 if (page.images) {\n                    page.images.forEach(function(img) {\n                        images.push({\n                            source: img.source,\n                            safe_source: img.source, \n                            mediaType: img.mediaType,\n                            data: img.data\n                        });\n                    });\n                }\n                \n                promises.push(Templates.render('mod_classengage/generator_slide_row', {\n                    pagenum: page.page,\n                    shorttext: shorttext,\n                    fulltext: page.text,\n                    hasmore: page.text.length > 100,\n                    images: images\n                }));\n            });\n\n            $.when.apply($, promises).done(function() {\n                var args = arguments;\n                // args is array of [html, js] pairs if multiple, or just [html, js] if one?\n                // jQuery when with array is tricky.\n                \n                // Let's iterate simply. \n                // Actually, renderForPromise is safer if we want to batch. \n                // But let's just append sequentially for simplicity in this V1.\n                \n                // Reset content\n                container.empty();\n                 // Show content, hide loading\n                self.modal.getRoot().find('#generator-loading').addClass('d-none');\n                self.modal.getRoot().find('#generator-content').removeClass('d-none');\n                self.modal.getRoot().find('#btn-generate-confirm').prop('disabled', false);\n\n                for (var i = 0; i < promises.length; i++) {\n                     // If multiple promises, 'arguments' has subarray for each\n                     // If one promise, 'arguments' is [html, js]\n                     var result = (promises.length > 1) ? arguments[i] : arguments;\n                     container.append(result[0]);\n                     Templates.runTemplateJS(result[1]);\n                }\n            });\n        },\n        \n        checkDistributionVisibility: function() {\n            var root = this.modal.getRoot();\n            var diff = root.find('#id_difficulty').val();\n            var bloom = root.find('#id_cognitive').val();\n            var num = parseInt(root.find('#id_numquestions').val());\n\n            var showPanel = false;\n            \n            // Difficulty Distribution\n            if (diff === 'mixed') {\n                root.find('#difficulty-dist').removeClass('d-none').addClass('d-block');\n                showPanel = true;\n                // Only distribute if total is 0 (first time show) or if total doesn't match\n                if (this.getSum('difficulty') !== num) {\n                    this.distributeEvenly('difficulty', num);\n                }\n            } else {\n                root.find('#difficulty-dist').removeClass('d-block').addClass('d-none');\n            }\n\n            // Bloom Distribution\n             if (bloom === 'mixed') {\n                root.find('#cognitive-dist').removeClass('d-none').addClass('d-block');\n                showPanel = true;\n                 if (this.getSum('bloom') !== num) {\n                    this.distributeEvenly('bloom', num);\n                 }\n            } else {\n                root.find('#cognitive-dist').removeClass('d-block').addClass('d-none');\n            }\n\n            if (showPanel) {\n                root.find('#advanced-distribution-panel').removeClass('d-none');\n            } else {\n                root.find('#advanced-distribution-panel').addClass('d-none');\n            }\n            \n            this.validateDistribution();\n        },\n\n        getSum: function(type) {\n             var sum = 0;\n             this.modal.getRoot().find('.dist-input[data-type=\"'+type+'\"]').each(function() {\n                 sum += parseInt($(this).val()) || 0;\n             });\n             return sum;\n        },\n\n        distributeEvenly: function(type, total) {\n             var inputs = this.modal.getRoot().find('.dist-input[data-type=\"'+type+'\"]');\n             var count = inputs.length;\n             var base = Math.floor(total / count);\n             var remainder = total % count;\n\n             inputs.each(function(index) {\n                 var val = base + (index < remainder ? 1 : 0);\n                 $(this).val(val);\n             });\n        },\n\n        validateDistribution: function() {\n            var root = this.modal.getRoot();\n            var totalTarget = parseInt(root.find('#id_numquestions').val());\n            var valid = true;\n            \n            // Check if panel is visible\n            if (root.find('#advanced-distribution-panel').hasClass('d-none')) {\n                root.find('#btn-generate-confirm').prop('disabled', false);\n                return true;\n            }\n\n            // Validate Difficulty if visible\n            if (!root.find('#difficulty-dist').hasClass('d-none')) {\n                var diffSum = this.getSum('difficulty');\n                if (diffSum !== totalTarget) {\n                    root.find('#diff-validation-msg').removeClass('d-none').text('Sum: ' + diffSum + ' / ' + totalTarget);\n                    valid = false;\n                } else {\n                    root.find('#diff-validation-msg').addClass('d-none');\n                }\n            }\n\n            // Validate Bloom if visible\n            if (!root.find('#cognitive-dist').hasClass('d-none')) {\n                var bloomSum = this.getSum('bloom');\n                if (bloomSum !== totalTarget) {\n                    root.find('#bloom-validation-msg').removeClass('d-none').text('Sum: ' + bloomSum + ' / ' + totalTarget);\n                    valid = false;\n                } else {\n                    root.find('#bloom-validation-msg').addClass('d-none');\n                }\n            }\n\n            root.find('#btn-generate-confirm').prop('disabled', !valid);\n            return valid;\n        },\n\n        updateSelectionFromRange: function(rangeStr) {\n            if (!rangeStr) {\n                return;\n            }\n            \n            var root = this.modal.getRoot();\n            // Uncheck all first\n            root.find('.slide-toggle').prop('checked', false);\n            \n            var parts = rangeStr.split(',');\n            parts.forEach(function(part) {\n                var bounds = part.trim().split('-');\n                if (bounds.length === 2) {\n                    var start = parseInt(bounds[0]);\n                    var end = parseInt(bounds[1]);\n                    for (var i = start; i <= end; i++) {\n                         root.find('.slide-row[data-page=\"'+i+'\"] .slide-toggle').prop('checked', true);\n                    }\n                } else if (bounds.length === 1 && bounds[0] !== \"\") {\n                    var p = parseInt(bounds[0]);\n                     root.find('.slide-row[data-page=\"'+p+'\"] .slide-toggle').prop('checked', true);\n                }\n            });\n        },\n\n        triggerGeneration: function() {\n            var self = this;\n            var root = self.modal.getRoot();\n            \n            // Collect Options\n            var numQuestions = parseInt(root.find('#id_numquestions').val());\n            var difficulty = root.find('#id_difficulty').val();\n            var bloomLevel = root.find('#id_cognitive').val();\n            \n            var difficultyDistribution = null;\n            var bloomDistribution = null;\n\n            if (difficulty === 'mixed') {\n                difficultyDistribution = {};\n                root.find('.dist-input[data-type=\"difficulty\"]').each(function() {\n                    difficultyDistribution[$(this).data('key')] = parseInt($(this).val()) || 0;\n                });\n            }\n\n            if (bloomLevel === 'mixed') {\n                bloomDistribution = {};\n                root.find('.dist-input[data-type=\"bloom\"]').each(function() {\n                    bloomDistribution[$(this).data('key')] = parseInt($(this).val()) || 0;\n                });\n            }\n            \n            var includeSlides = [];\n            root.find('.slide-toggle:checked').each(function() {\n                // Get page number from data-page of parent row\n                var row = $(this).closest('.slide-row');\n                includeSlides.push(row.data('page'));\n            });\n            \n            var includeImages = [];\n            root.find('.image-toggle:checked').each(function() {\n                // Source is in name=\"include_image[SOURCE]\" -- Wait, extracting from name is messy\n                // Let's use data attribute?\n                includeImages.push($(this).closest('.d-inline-block').find('img').attr('src')); // No, src is base64\n                \n                // We need the source ID.\n                // The template didn't put it in a clean data attrib.\n                // Re-check template: input name=\"include_image[{{safe_source}}]\"\n                // We can parse the name.\n                var name = $(this).attr('name');\n                if (name) {\n                    var match = name.match(/include_image\\[(.*)\\]/);\n                    if (match) {\n                         includeImages.push(match[1]);\n                    }\n                }\n            });\n\n            var options = {\n                numQuestions: numQuestions,\n                difficulty: difficulty,\n                bloomLevel: bloomLevel,\n                includeSlides: includeSlides,\n                includeImages: includeImages\n            };\n\n            if (difficultyDistribution) {\n                options.difficultyDistribution = difficultyDistribution;\n            }\n            if (bloomDistribution) {\n                options.bloomDistribution = bloomDistribution;\n            }\n            \n            // UI Loading state\n            root.find('#btn-generate-confirm').prop('disabled', true).html('<i class=\"fa fa-spinner fa-spin\"></i> Generating...');\n            \n            $.ajax({\n                url: M.cfg.wwwroot + '/mod/classengage/slides_api.php',\n                type: 'POST',\n                data: {\n                    action: 'generate_from_options',\n                    slideid: self.slideid,\n                    docid: self.docid,\n                    options: JSON.stringify(options),\n                    sesskey: M.cfg.sesskey\n                },\n                dataType: 'json',\n                success: function(response) {\n                    if (response.success) {\n                        self.modal.hide();\n                        window.location.reload(); // Reload to see new questions\n                    } else {\n                        alert('Error: ' + response.error);\n                        root.find('#btn-generate-confirm').prop('disabled', false).text('Generate');\n                    }\n                },\n                error: function() {\n                    alert('Network error during generation.');\n                     root.find('#btn-generate-confirm').prop('disabled', false).text('Generate');\n                }\n            });\n        }\n    };\n\n    return GeneratorWizard;\n});\n"],"names":["define","$","ModalFactory","ModalEvents","Templates","Ajax","Notification","Str","GeneratorWizard","modal","cmid","slideid","docid","pages","init","document","on","e","preventDefault","btn","currentTarget","data","openWizard","bind","this","self","create","type","types","DEFAULT","large","then","get_string","title","setTitle","render","numquestions_options","html","js","setBody","runTemplateJS","setFooter","show","inspectDocument","root","getRoot","updateSelectionFromRange","val","checked","is","find","prop","triggerGeneration","link","alert","checkDistributionVisibility","validateDistribution","fail","exception","call","methodname","args","ajax","url","M","cfg","wwwroot","action","sesskey","dataType","success","response","renderPages","error","container","empty","forEach","page","shorttext","text","replace","substring","images","img","push","source","safe_source","mediaType","append","pagenum","fulltext","hasmore","length","promises","when","apply","done","addClass","removeClass","i","result","arguments","diff","bloom","num","parseInt","showPanel","getSum","distributeEvenly","sum","each","total","inputs","count","base","Math","floor","remainder","index","totalTarget","valid","hasClass","diffSum","bloomSum","rangeStr","split","part","bounds","trim","start","end","p","numQuestions","difficulty","bloomLevel","difficultyDistribution","bloomDistribution","includeSlides","row","closest","includeImages","attr","name","match","options","JSON","stringify","hide","window","location","reload"],"mappings":"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"}