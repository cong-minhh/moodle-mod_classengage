{"version":3,"file":"analytics_charts.min.js","sources":["../src/analytics_charts.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * JavaScript for Chart.js visualizations in analytics\n *\n * This module handles:\n * - Engagement timeline line chart with peak/dip highlighting\n * - Concept difficulty horizontal bar chart with color coding\n * - Participation distribution doughnut chart\n * - Responsive chart configurations\n * - Tooltips with detailed information\n * - WCAG AA compliant color schemes\n * - Text alternatives for accessibility\n *\n * @module     mod_classengage/analytics_charts\n * @copyright  2025 Danielle\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['core/chartjs', 'core/str'],\n    function(Chart, Str) {\n\n    // Chart configuration constants\n    const CHART_CONFIG = {\n        LABEL_MAX_LENGTH: 40,\n        POINT_RADIUS_HIGHLIGHT: 6,\n        POINT_RADIUS_NORMAL: 3,\n        POINT_RADIUS_HOVER: 8,\n        LINE_TENSION: 0.3,\n        TITLE_FONT_SIZE: 16,\n\n        // Difficulty thresholds\n        DIFFICULTY_EASY_THRESHOLD: 70,\n        DIFFICULTY_MODERATE_THRESHOLD: 50\n    };\n\n    // Color constants with WCAG AA contrast compliance\n    const COLORS = {\n        // Engagement timeline colors\n        TIMELINE_LINE: '#0f6cbf', // Primary blue\n        TIMELINE_PEAK: '#28a745', // Success green\n        TIMELINE_DIP: '#fd7e14', // Warning orange\n        TIMELINE_BACKGROUND: 'rgba(15, 108, 191, 0.1)',\n\n        // Concept difficulty colors\n        DIFFICULTY_EASY: '#28a745', // Green (>70%)\n        DIFFICULTY_MODERATE: '#ffc107', // Yellow (50-70%)\n        DIFFICULTY_HARD: '#dc3545', // Red (<50%)\n\n        // Participation distribution colors\n        PARTICIPATION_HIGH: '#28a745', // Green (5+ responses)\n        PARTICIPATION_MODERATE: '#17a2b8', // Blue (2-4 responses)\n        PARTICIPATION_LOW: '#ffc107', // Yellow (1 response)\n        PARTICIPATION_NONE: '#6c757d' // Gray (0 responses)\n    };\n\n    // Chart instances storage\n    let chartInstances = {\n        timeline: null,\n        difficulty: null,\n        distribution: null\n    };\n\n    /**\n     * Get canvas context or return null if not found\n     *\n     * @param {string} canvasId Canvas element ID\n     * @returns {Object|null} Object with canvas and context, or null if not found\n     * @private\n     */\n    const getCanvasContext = function(canvasId) {\n        const canvas = document.getElementById(canvasId);\n        if (!canvas) {\n            // eslint-disable-next-line no-console\n            console.warn('Canvas ' + canvasId + ' not found');\n            return null;\n        }\n        return {\n            canvas: canvas,\n            ctx: canvas.getContext('2d')\n        };\n    };\n\n    /**\n     * Destroy chart instance if it exists\n     *\n     * @param {string} chartKey Key in chartInstances object\n     * @private\n     */\n    const destroyChartIfExists = function(chartKey) {\n        if (chartInstances[chartKey]) {\n            chartInstances[chartKey].destroy();\n            chartInstances[chartKey] = null;\n        }\n    };\n\n    /**\n     * Get color for difficulty level based on correctness rate\n     *\n     * @param {number} correctnessRate Correctness rate percentage\n     * @returns {string} Color hex code\n     * @private\n     */\n    const getDifficultyColor = function(correctnessRate) {\n        if (correctnessRate >= CHART_CONFIG.DIFFICULTY_EASY_THRESHOLD) {\n            return COLORS.DIFFICULTY_EASY;\n        } else if (correctnessRate >= CHART_CONFIG.DIFFICULTY_MODERATE_THRESHOLD) {\n            return COLORS.DIFFICULTY_MODERATE;\n        }\n        return COLORS.DIFFICULTY_HARD;\n    };\n\n    /**\n     * Get common chart options\n     *\n     * @param {string} title Chart title\n     * @param {Object} additionalOptions Additional chart-specific options\n     * @returns {Object} Chart options object\n     * @private\n     */\n    const getCommonChartOptions = function(title, additionalOptions) {\n        const baseOptions = {\n            responsive: true,\n            maintainAspectRatio: false,\n            plugins: {\n                title: {\n                    display: true,\n                    text: title,\n                    font: {\n                        size: CHART_CONFIG.TITLE_FONT_SIZE,\n                        weight: 'bold'\n                    }\n                }\n            }\n        };\n\n        // Merge additional options\n        if (additionalOptions) {\n            if (additionalOptions.plugins) {\n                Object.assign(baseOptions.plugins, additionalOptions.plugins);\n            }\n            Object.keys(additionalOptions).forEach(function(key) {\n                if (key !== 'plugins') {\n                    baseOptions[key] = additionalOptions[key];\n                }\n            });\n        }\n\n        return baseOptions;\n    };\n\n    /**\n     * Initialize all charts by reading data from data attribute\n     */\n    const init = function() {\n        // Get chart data from data attribute\n        const dataElement = document.getElementById('analytics-chart-data');\n        if (!dataElement) {\n            // eslint-disable-next-line no-console\n            console.warn('Chart data element not found');\n            return;\n        }\n\n        const chartDataJson = dataElement.getAttribute('data-chartdata');\n        if (!chartDataJson) {\n            // eslint-disable-next-line no-console\n            console.warn('Chart data attribute is empty');\n            return;\n        }\n\n        let chartData;\n        try {\n            chartData = JSON.parse(chartDataJson);\n        } catch (e) {\n            // eslint-disable-next-line no-console\n            console.error('Failed to parse chart data:', e);\n            return;\n        }\n\n        // Validate input\n        if (!chartData || typeof chartData !== 'object') {\n            // eslint-disable-next-line no-console\n            console.error('Invalid chart data provided');\n            return;\n        }\n\n        if (chartData.timeline && Array.isArray(chartData.timeline)) {\n            initEngagementTimeline(chartData.timeline);\n        }\n\n        if (chartData.difficulty && Array.isArray(chartData.difficulty)) {\n            initConceptDifficulty(chartData.difficulty);\n        }\n\n        if (chartData.distribution && typeof chartData.distribution === 'object') {\n            initParticipationDistribution(chartData.distribution);\n        }\n    };\n\n    /**\n     * Initialize engagement timeline line chart\n     *\n     * @param {Array} timelineData Timeline data with intervals, counts, peaks, and dips\n     * @private\n     */\n    const initEngagementTimeline = function(timelineData) {\n        const canvasData = getCanvasContext('engagement-timeline-chart');\n        if (!canvasData) {\n            return;\n        }\n\n        // Destroy existing chart if it exists\n        destroyChartIfExists('timeline');\n\n        // Prepare data - optimize by using single reduce instead of multiple maps\n        const chartData = timelineData.reduce(function(acc, interval) {\n            acc.labels.push(interval.label);\n            acc.counts.push(interval.count);\n\n            if (interval.is_peak) {\n                acc.pointBackgroundColors.push(COLORS.TIMELINE_PEAK);\n                acc.pointRadius.push(CHART_CONFIG.POINT_RADIUS_HIGHLIGHT);\n            } else if (interval.is_dip) {\n                acc.pointBackgroundColors.push(COLORS.TIMELINE_DIP);\n                acc.pointRadius.push(CHART_CONFIG.POINT_RADIUS_HIGHLIGHT);\n            } else {\n                acc.pointBackgroundColors.push(COLORS.TIMELINE_LINE);\n                acc.pointRadius.push(CHART_CONFIG.POINT_RADIUS_NORMAL);\n            }\n\n            return acc;\n        }, {\n            labels: [],\n            counts: [],\n            pointBackgroundColors: [],\n            pointRadius: []\n        });\n\n        // Get language strings for accessibility\n        Str.get_strings([\n            {key: 'engagementtimeline', component: 'mod_classengage'},\n            {key: 'timelinepeak', component: 'mod_classengage'},\n            {key: 'timelinedip', component: 'mod_classengage'}\n        ]).then(function(strings) {\n            const chartTitle = strings[0];\n            const peakLabel = strings[1];\n            const dipLabel = strings[2];\n\n            // Build chart options\n            const options = getCommonChartOptions(chartTitle, {\n                plugins: {\n                    legend: {\n                        display: false\n                    },\n                    tooltip: {\n                        callbacks: {\n                            label: function(context) {\n                                const interval = timelineData[context.dataIndex];\n                                let label = context.dataset.label + ': ' + context.parsed.y;\n\n                                if (interval.is_peak) {\n                                    label += ' (' + peakLabel + ')';\n                                } else if (interval.is_dip) {\n                                    label += ' (' + dipLabel + ')';\n                                }\n\n                                return label;\n                            }\n                        }\n                    }\n                },\n                scales: {\n                    x: {\n                        title: {\n                            display: true,\n                            text: 'Time'\n                        },\n                        grid: {\n                            display: false\n                        }\n                    },\n                    y: {\n                        title: {\n                            display: true,\n                            text: 'Response Count'\n                        },\n                        beginAtZero: true,\n                        ticks: {\n                            precision: 0\n                        }\n                    }\n                }\n            });\n\n            // Create chart\n            chartInstances.timeline = new Chart(canvasData.ctx, {\n                type: 'line',\n                data: {\n                    labels: chartData.labels,\n                    datasets: [{\n                        label: chartTitle,\n                        data: chartData.counts,\n                        borderColor: COLORS.TIMELINE_LINE,\n                        backgroundColor: COLORS.TIMELINE_BACKGROUND,\n                        pointBackgroundColor: chartData.pointBackgroundColors,\n                        pointBorderColor: chartData.pointBackgroundColors,\n                        pointRadius: chartData.pointRadius,\n                        pointHoverRadius: CHART_CONFIG.POINT_RADIUS_HOVER,\n                        fill: true,\n                        tension: CHART_CONFIG.LINE_TENSION\n                    }]\n                },\n                options: options\n            });\n\n            // Add text alternative for accessibility\n            canvasData.canvas.setAttribute('aria-label', chartTitle + '. ' + generateTimelineTextAlternative(timelineData));\n\n            return true;\n        }).catch(function(error) {\n            // eslint-disable-next-line no-console\n            console.error('Failed to load language strings for timeline chart:', error);\n        });\n    };\n\n    /**\n     * Initialize concept difficulty horizontal bar chart\n     *\n     * @param {Array} difficultyData Concept difficulty data with questions and correctness rates\n     * @private\n     */\n    const initConceptDifficulty = function(difficultyData) {\n        const canvasData = getCanvasContext('concept-difficulty-chart');\n        if (!canvasData) {\n            return;\n        }\n\n        // Destroy existing chart if it exists\n        destroyChartIfExists('difficulty');\n\n        // Prepare data - truncate long question texts and assign colors\n        const labels = difficultyData.map(function(concept) {\n            const text = concept.question_text;\n            return text.length > CHART_CONFIG.LABEL_MAX_LENGTH ?\n                text.substring(0, CHART_CONFIG.LABEL_MAX_LENGTH) + '...' : text;\n        });\n\n        const correctnessRates = difficultyData.map(function(concept) {\n            return concept.correctness_rate;\n        });\n\n        // Color code based on difficulty using helper function\n        const backgroundColors = difficultyData.map(function(concept) {\n            return getDifficultyColor(concept.correctness_rate);\n        });\n\n        // Get language strings\n        Str.get_strings([\n            {key: 'conceptdifficulty', component: 'mod_classengage'}\n        ]).then(function(strings) {\n            const chartTitle = strings[0];\n\n            // Build chart options\n            const options = getCommonChartOptions(chartTitle, {\n                indexAxis: 'y',\n                plugins: {\n                    legend: {\n                        display: false\n                    },\n                    tooltip: {\n                        callbacks: {\n                            title: function(context) {\n                                // Show full question text in tooltip\n                                return difficultyData[context[0].dataIndex].question_text;\n                            },\n                            label: function(context) {\n                                return 'Correctness: ' + context.parsed.x.toFixed(1) + '%';\n                            }\n                        }\n                    }\n                },\n                scales: {\n                    x: {\n                        title: {\n                            display: true,\n                            text: 'Correctness Rate (%)'\n                        },\n                        beginAtZero: true,\n                        max: 100,\n                        ticks: {\n                            callback: function(value) {\n                                return value + '%';\n                            }\n                        }\n                    },\n                    y: {\n                        title: {\n                            display: false\n                        }\n                    }\n                }\n            });\n\n            // Create chart\n            chartInstances.difficulty = new Chart(canvasData.ctx, {\n                type: 'bar',\n                data: {\n                    labels: labels,\n                    datasets: [{\n                        label: 'Correctness Rate (%)',\n                        data: correctnessRates,\n                        backgroundColor: backgroundColors,\n                        borderColor: backgroundColors,\n                        borderWidth: 1\n                    }]\n                },\n                options: options\n            });\n\n            // Add text alternative for accessibility\n            canvasData.canvas.setAttribute('aria-label', chartTitle + '. ' + generateDifficultyTextAlternative(difficultyData));\n\n            return true;\n        }).catch(function(error) {\n            // eslint-disable-next-line no-console\n            console.error('Failed to load language strings for difficulty chart:', error);\n        });\n    };\n\n    /**\n     * Initialize participation distribution doughnut chart\n     *\n     * @param {Object} distributionData Participation distribution data with counts per category\n     * @private\n     */\n    const initParticipationDistribution = function(distributionData) {\n        const canvasData = getCanvasContext('participation-distribution-chart');\n        if (!canvasData) {\n            return;\n        }\n\n        // Destroy existing chart if it exists\n        destroyChartIfExists('distribution');\n\n        // Get language strings\n        Str.get_strings([\n            {key: 'participationdistribution', component: 'mod_classengage'},\n            {key: 'participationhigh', component: 'mod_classengage'},\n            {key: 'participationmoderate', component: 'mod_classengage'},\n            {key: 'participationlow', component: 'mod_classengage'},\n            {key: 'participationnone', component: 'mod_classengage'}\n        ]).then(function(strings) {\n            const chartTitle = strings[0];\n            const highLabel = strings[1];\n            const moderateLabel = strings[2];\n            const lowLabel = strings[3];\n            const noneLabel = strings[4];\n\n            const labels = [highLabel, moderateLabel, lowLabel, noneLabel];\n            const data = [\n                distributionData.high || 0,\n                distributionData.moderate || 0,\n                distributionData.low || 0,\n                distributionData.none || 0\n            ];\n\n            const backgroundColors = [\n                COLORS.PARTICIPATION_HIGH,\n                COLORS.PARTICIPATION_MODERATE,\n                COLORS.PARTICIPATION_LOW,\n                COLORS.PARTICIPATION_NONE\n            ];\n\n            const totalStudents = data.reduce(function(sum, count) {\n                return sum + count;\n            }, 0);\n\n            // Build chart options\n            const options = getCommonChartOptions(chartTitle, {\n                plugins: {\n                    legend: {\n                        display: true,\n                        position: 'bottom'\n                    },\n                    tooltip: {\n                        callbacks: {\n                            label: function(context) {\n                                const count = context.parsed;\n                                const percentage = totalStudents > 0\n                                    ? ((count / totalStudents) * 100).toFixed(1)\n                                    : 0;\n                                return context.label + ': ' + count + ' (' + percentage + '%)';\n                            }\n                        }\n                    }\n                }\n            });\n\n            // Create chart\n            chartInstances.distribution = new Chart(canvasData.ctx, {\n                type: 'doughnut',\n                data: {\n                    labels: labels,\n                    datasets: [{\n                        data: data,\n                        backgroundColor: backgroundColors,\n                        borderColor: '#fff',\n                        borderWidth: 2\n                    }]\n                },\n                options: options\n            });\n\n            // Add text alternative for accessibility\n            canvasData.canvas.setAttribute('aria-label', chartTitle + '. ' + generateDistributionTextAlternative(distributionData));\n\n            return true;\n        }).catch(function(error) {\n            // eslint-disable-next-line no-console\n            console.error('Failed to load language strings for distribution chart:', error);\n        });\n    };\n\n    /**\n     * Generate text alternative for engagement timeline chart\n     *\n     * @param {Array} timelineData Timeline data\n     * @returns {String} Text description of the chart\n     * @private\n     */\n    const generateTimelineTextAlternative = function(timelineData) {\n        if (!timelineData || timelineData.length === 0) {\n            return 'No timeline data available.';\n        }\n\n        const totalIntervals = timelineData.length;\n        const totalResponses = timelineData.reduce((sum, interval) => sum + interval.count, 0);\n        const avgResponses = (totalResponses / totalIntervals).toFixed(1);\n\n        const peaks = timelineData.filter(interval => interval.is_peak);\n        const dips = timelineData.filter(interval => interval.is_dip);\n\n        let description = `Timeline shows ${totalIntervals} intervals with ${totalResponses} total responses, ` +\n            `averaging ${avgResponses} responses per interval.`;\n\n        if (peaks.length > 0) {\n            description += ` Peak engagement at ${peaks.map(p => p.label).join(', ')}.`;\n        }\n\n        if (dips.length > 0) {\n            description += ` Attention dips at ${dips.map(d => d.label).join(', ')}.`;\n        }\n\n        return description;\n    };\n\n    /**\n     * Generate text alternative for concept difficulty chart\n     *\n     * @param {Array} difficultyData Difficulty data\n     * @returns {String} Text description of the chart\n     * @private\n     */\n    const generateDifficultyTextAlternative = function(difficultyData) {\n        if (!difficultyData || difficultyData.length === 0) {\n            return 'No concept difficulty data available.';\n        }\n\n        const totalConcepts = difficultyData.length;\n        const avgCorrectness = (difficultyData.reduce((sum, c) => sum + c.correctness_rate, 0) / totalConcepts).toFixed(1);\n\n        const difficult = difficultyData.filter(c => c.correctness_rate < 50).length;\n        const moderate = difficultyData.filter(c => c.correctness_rate >= 50 && c.correctness_rate < 70).length;\n        const easy = difficultyData.filter(c => c.correctness_rate >= 70).length;\n\n        return `Chart shows ${totalConcepts} concepts with average correctness of ${avgCorrectness}%. ` +\n            `${difficult} difficult, ${moderate} moderate, ${easy} well-understood.`;\n    };\n\n    /**\n     * Generate text alternative for participation distribution chart\n     *\n     * @param {Object} distributionData Distribution data\n     * @returns {String} Text description of the chart\n     * @private\n     */\n    const generateDistributionTextAlternative = function(distributionData) {\n        const high = distributionData.high || 0;\n        const moderate = distributionData.moderate || 0;\n        const low = distributionData.low || 0;\n        const none = distributionData.none || 0;\n        const total = high + moderate + low + none;\n\n        if (total === 0) {\n            return 'No participation data available.';\n        }\n\n        return `Distribution of ${total} students: ${high} high participation, ` +\n            `${moderate} moderate, ${low} low, ${none} no participation.`;\n    };\n\n    /**\n     * Destroy all chart instances\n     * Useful for cleanup when navigating away or refreshing data\n     */\n    const destroyCharts = function() {\n        Object.keys(chartInstances).forEach(function(key) {\n            if (chartInstances[key]) {\n                chartInstances[key].destroy();\n                chartInstances[key] = null;\n            }\n        });\n    };\n\n    // Public API\n    return {\n        init: init,\n        initEngagementTimeline: initEngagementTimeline,\n        initConceptDifficulty: initConceptDifficulty,\n        initParticipationDistribution: initParticipationDistribution,\n        destroyCharts: destroyCharts\n    };\n});\n"],"names":["define","Chart","Str","CHART_CONFIG","COLORS","chartInstances","timeline","difficulty","distribution","getCanvasContext","canvasId","canvas","document","getElementById","ctx","getContext","console","warn","destroyChartIfExists","chartKey","destroy","getCommonChartOptions","title","additionalOptions","baseOptions","responsive","maintainAspectRatio","plugins","display","text","font","size","weight","Object","assign","keys","forEach","key","initEngagementTimeline","timelineData","canvasData","chartData","reduce","acc","interval","labels","push","label","counts","count","is_peak","pointBackgroundColors","pointRadius","is_dip","get_strings","component","then","strings","chartTitle","peakLabel","dipLabel","options","legend","tooltip","callbacks","context","dataIndex","dataset","parsed","y","scales","x","grid","beginAtZero","ticks","precision","type","data","datasets","borderColor","backgroundColor","pointBackgroundColor","pointBorderColor","pointHoverRadius","fill","tension","setAttribute","generateTimelineTextAlternative","catch","error","initConceptDifficulty","difficultyData","map","concept","question_text","length","substring","correctnessRates","correctness_rate","backgroundColors","correctnessRate","indexAxis","toFixed","max","callback","value","borderWidth","generateDifficultyTextAlternative","initParticipationDistribution","distributionData","high","moderate","low","none","totalStudents","sum","position","percentage","generateDistributionTextAlternative","totalIntervals","totalResponses","avgResponses","peaks","filter","dips","description","p","join","d","totalConcepts","c","total","init","dataElement","chartDataJson","getAttribute","JSON","parse","e","Array","isArray","destroyCharts"],"mappings":"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"}