/**
 * Slides Manager - Professional JavaScript Module
 * Handles all interactive features for the slides management interface
 *
 * @module mod_classengage/slides_manager
 * @copyright 2025 Danielle
 * @license http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 */
define("mod_classengage/slides_manager",["jquery","core/ajax","core/notification","core/str"],(function($,Ajax,Notification,Str){return{init:contextid=>{(()=>{const selectAll=$("#select-all-slides"),checkboxes=$(".slide-checkbox"),bulkToolbar=$("#bulk-toolbar"),bulkDeleteBtn=$("#bulk-delete-btn"),selectedCount=$("#selected-count"),cancelBtn=$("#cancel-selection-btn"),updateBulkSelection=()=>{let checkedCount=0;checkboxes.each((function(){$(this).is(":checked")?(checkedCount++,$(this).closest(".slide-item").addClass("selected")):$(this).closest(".slide-item").removeClass("selected")})),checkedCount>0?(bulkToolbar.fadeIn(300).addClass("slide-in-down"),bulkDeleteBtn.prop("disabled",!1),Str.get_string("selected","mod_classengage").then((function(str){selectedCount.text(checkedCount+" "+str)})).catch(Notification.exception)):(bulkToolbar.fadeOut(300),bulkDeleteBtn.prop("disabled",!0))};selectAll.on("change",(function(){checkboxes.prop("checked",$(this).is(":checked")),updateBulkSelection()})),checkboxes.on("change",(function(){updateBulkSelection(),$(this).is(":checked")||selectAll.prop("checked",!1)})),cancelBtn.on("click",(function(){checkboxes.prop("checked",!1),selectAll.prop("checked",!1),updateBulkSelection()}))})(),(()=>{let searchTimeout;$("#slide-search").on("input",(function(){clearTimeout(searchTimeout);const searchTerm=$(this).val().toLowerCase();searchTimeout=setTimeout((()=>{let visibleCount=0;$(".slide-item").each((function(){const title=$(this).data("slide-title").toLowerCase(),filename=$(this).data("slide-filename").toLowerCase();title.includes(searchTerm)||filename.includes(searchTerm)?($(this).fadeIn(300),visibleCount++):$(this).fadeOut(300)})),0===visibleCount&&""!==searchTerm?0===$("#no-results-message").length&&Str.get_string("noresultsfound","mod_classengage").then((function(str){$("#slides-grid").append('<div id="no-results-message" class="col-12 text-center py-5"><i class="fa fa-search fa-3x text-muted mb-3"></i><p class="text-muted">'+str+"</p></div>")})).catch(Notification.exception):$("#no-results-message").remove()}),300)}))})(),$("#status-filter").on("change",(function(){const status=$(this).val();$(".slide-item").each((function(){"all"===status||$(this).data("slide-status")===status?$(this).fadeIn(300):$(this).fadeOut(300)}))})),(()=>{const gridViewBtn=$("#grid-view-btn"),listViewBtn=$("#list-view-btn"),slidesGrid=$("#slides-grid");gridViewBtn.on("click",(function(){slidesGrid.removeClass("list-view"),$(this).addClass("active"),listViewBtn.removeClass("active"),localStorage.setItem("classengage_view_mode","grid")})),listViewBtn.on("click",(function(){slidesGrid.addClass("list-view"),$(this).addClass("active"),gridViewBtn.removeClass("active"),localStorage.setItem("classengage_view_mode","list")}));"list"===localStorage.getItem("classengage_view_mode")&&listViewBtn.trigger("click")})(),$(".classengage-slide-card").hover((function(){$(this).addClass("card-hover")}),(function(){$(this).removeClass("card-hover")})),$('[data-toggle="modal"][data-target="#preview-modal"]').on("click",(function(){const slideId=$(this).data("slide-id"),previewContent=$("#preview-content");Promise.all([Str.get_string("loadingpreview","mod_classengage"),Str.get_string("previewnotavailable","mod_classengage"),Str.get_string("errorloadingpreview","mod_classengage")]).then((function(strings){const[loadingStr,notAvailableStr,errorStr]=strings;previewContent.html('<div class="text-center p-5"><div class="classengage-loading"></div><p class="mt-3 text-muted">'+loadingStr+"</p></div>"),Ajax.call([{methodname:"mod_classengage_get_slide_preview",args:{slideid:slideId,contextid:contextid}}])[0].then((function(response){response.success?previewContent.html(response.html):previewContent.html('<div class="alert alert-warning"><i class="fa fa-exclamation-triangle"></i> '+notAvailableStr+"</div>")})).catch((function(error){previewContent.html('<div class="alert alert-danger"><i class="fa fa-times-circle"></i> '+errorStr+": "+error.message+"</div>"),Notification.exception(error)}))})).catch(Notification.exception)})),(()=>{const scrollBtn=$("<button>",{id:"scroll-to-top",class:"btn btn-primary",html:'<i class="fa fa-arrow-up"></i>',css:{position:"fixed",bottom:"30px",right:"30px",display:"none","z-index":1e3,"border-radius":"50%",width:"50px",height:"50px","box-shadow":"0 4px 12px rgba(0,0,0,0.15)"}});$("body").append(scrollBtn),$(window).on("scroll",(function(){$(this).scrollTop()>300?scrollBtn.fadeIn(300):scrollBtn.fadeOut(300)})),scrollBtn.on("click",(function(){$("html, body").animate({scrollTop:0},600)}))})(),$(document).on("keydown",(function(e){(e.ctrlKey||e.metaKey)&&"f"===e.key&&(e.preventDefault(),$("#slide-search").focus()),!e.ctrlKey&&!e.metaKey||"a"!==e.key||$(e.target).is("input, textarea")||(e.preventDefault(),$("#select-all-slides").prop("checked",!0).trigger("change")),"Escape"===e.key&&$("#cancel-selection-btn").trigger("click")})),$("[title]").tooltip({placement:"top",trigger:"hover",delay:{show:500,hide:100}}),$('.slide-item[data-slide-status="processing"]').each((function(){$(this).find(".classengage-card-body").append('<div class="progress mt-3" style="height: 4px;"><div class="progress-bar progress-bar-striped progress-bar-animated" role="progressbar" style="width: 100%"></div></div>')})),$('.slide-item[data-slide-status="processing"]').length>0&&setTimeout((function(){location.reload()}),1e4),$(".slide-item").each((function(index){$(this).css("animation-delay",.05*index+"s")}))}}}));

//# sourceMappingURL=slides_manager.min.js.map